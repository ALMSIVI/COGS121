<html>
<head>
<title>LyricApp</title>

<script src="jquery-3.3.1.min.js"></script>

<script type="text/javascript">
$(document).ready(() => {
  $('#readLyrics').click(() => {
    const requestURL = 'songs/' + $('#newSong').val();
    const tlyricURL = 'songs/' + $('#newSong').val(); + '/tlyric'
    const originalLyric = $('#lyrics').val();
    const translatedLyric = $('#translatedlyrics').val();
    //console.log('read button clicked!');
    console.log(originalLyric);
    $.ajax({
      url: requestURL,
      type: 'GET',
      dataType: 'json',
      success: (data) => {
        //console.log(data);

        if(data.original) {
          $('#status').html('Song already exists at URL: ' + requestURL);
          //$('#jobDiv').html('My job is ' + data.job);
          //$('#petImage').attr('src', data.pet);
        } else {
          $('#status').html('Error: could not find user at URL: ' + requestURL);
        }

      }
    });

    $.ajax({
      url: requestURL,
      type: "POST",
      dataType: 'text',
      data: {
                'original': originalLyric,
                'translated': translatedLyric
            },
      success: (data) => {

        if(data.original) {
          $('#status').html('Song already exists at URL: ' + requestURL);
          //$('#jobDiv').html('My job is ' + data.job);
          //$('#petImage').attr('src', data.pet);
        } else {
          $('#status').html('Error: could not find user at URL: ' + requestURL);
        }

      }
    });



  });

  $('#songSelection').click(() => {
    const songName = $('#songname').val();
    const songSelectURL = 'select/' + songName
    $.ajax({
      url: songSelectURL,
      type: 'GET',
      dataType: 'json',
      success: (data) => {
        $('#status').html('Original: \n' + data.original);
        $('#jobDiv').html('Translated: \n' + data.translated);
      }
    })
  })



  $('#readLyrics').click(() => {
    $.ajax({
      url: 'songs/',
      type: 'GET',
      dataType: 'json',
      success: (data) => {
        //console.log(data);
        $('#status').html('All users: ' + data);
      }
    });
  });
});
</script>

</head>
<body>
  <h1>Transracer!</h1>
  Name of Song: <input type="text" id ="newSong">
  <div>
  <textarea id = "lyrics" rows="20" cols="50" name="comment" form="usrform">
  Enter original lyrics here...</textarea>
  <textarea id = "translatedlyrics" rows="20" cols="50" name="comment" form="usrform">
  Enter translated lyrics here...</textarea>
  <div>
  <button id ="readLyrics">Save Song</button>
  <div>
  Start Transracing!
  <div>
  Enter Song Name: <input type= "text" id = "songname">
  <button id ="songSelection">Go!</button>

  <div id="jobDiv"></div>
  <img id="petImage"></img>

  <hr/>

  <div id="status"></div>
</body>
</html>
